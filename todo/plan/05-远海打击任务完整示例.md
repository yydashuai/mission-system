# è¿œæµ·æ‰“å‡»ä»»åŠ¡å®Œæ•´ç¤ºä¾‹

æœ¬æ–‡æ¡£å±•ç¤ºå¦‚ä½•åœ¨K8så¹³å°ä¸Šéƒ¨ç½²å’Œæ‰§è¡Œ"è¿œæµ·æ–¹å‘é‡è¦ç›®æ ‡ç»¼åˆä¾¦å¯Ÿâ€”å‹åˆ¶â€”æ‰“å‡»ç¤ºèŒƒè¡ŒåŠ¨"ã€‚

## ä¸€ã€å‰ç½®å‡†å¤‡

### 1.1 é›†ç¾¤ç¯å¢ƒ

```bash
# é›†ç¾¤ä¿¡æ¯
kubectl cluster-info

# ç¡®è®¤CRDå·²å®‰è£…
kubectl get crd | grep airforce.mil

# è¾“å‡ºåº”åŒ…å«ï¼š
# missions.airforce.mil
# missionstages.airforce.mil
# flighttasks.airforce.mil
# weapons.airforce.mil
```

### 1.2 é£æœºèŠ‚ç‚¹å‡†å¤‡

```bash
# æŸ¥çœ‹æ‰€æœ‰é£æœºèŠ‚ç‚¹
kubectl get nodes -l aircraft.mil/type

# è¾“å‡ºç¤ºä¾‹ï¼š
# NAME          STATUS   ROLES    AGE   VERSION
# kj500-01      Ready    <none>   5d    v1.28.0
# wz10-01       Ready    <none>   5d    v1.28.0
# wz10-02       Ready    <none>   5d    v1.28.0
# j20-01        Ready    <none>   5d    v1.28.0
# j20-02        Ready    <none>   5d    v1.28.0
# j16d-01       Ready    <none>   5d    v1.28.0
# h6k-01        Ready    <none>   5d    v1.28.0
# gj11-01       Ready    <none>   5d    v1.28.0
# yy20a-01      Ready    <none>   5d    v1.28.0
```

### 1.3 æ­¦å™¨èµ„æºå‡†å¤‡

```yaml
# weapons/pl15-missile.yaml
apiVersion: airforce.mil/v1alpha1
kind: Weapon
metadata:
  name: pl15-missile
  namespace: weapons
spec:
  weaponName: "éœ¹é›³-15ä¸­è¿œç¨‹ç©ºç©ºå¯¼å¼¹"
  weaponType: air-to-air-missile
  category: beyond-visual-range

  specifications:
    manufacturer: "ä¸­å›½èˆªå¤©ç§‘å·¥é›†å›¢"
    weight: 200kg
    range: 200km
    guidance: "ä¸»åŠ¨é›·è¾¾åˆ¶å¯¼"

  image:
    repository: registry.mil/weapons/pl15-missile
    tag: v2.3.0

  resources:
    hardpoints: 1
    weight: 200

  compatibility:
    aircraftTypes: [j20, j16]
    hardpointTypes: [internal-bay, under-wing]

  container:
    env:
    - name: WEAPON_TYPE
      value: "pl15"
    volumeMounts:
    - name: weapon-interface
      mountPath: /interface
    ports:
    - name: grpc
      containerPort: 9001

---
# weapons/pl10-missile.yaml
apiVersion: airforce.mil/v1alpha1
kind: Weapon
metadata:
  name: pl10-missile
  namespace: weapons
spec:
  weaponName: "éœ¹é›³-10è¿‘è·æ ¼æ–—å¯¼å¼¹"
  weaponType: air-to-air-missile
  category: within-visual-range

  image:
    repository: registry.mil/weapons/pl10-missile
    tag: v1.8.0

  resources:
    hardpoints: 1
    weight: 90

  compatibility:
    aircraftTypes: [j20]
    hardpointTypes: [internal-bay]

---
# weapons/akd20-missile.yaml
apiVersion: airforce.mil/v1alpha1
kind: Weapon
metadata:
  name: akd20-cruise-missile
  namespace: weapons
spec:
  weaponName: "AKD-20ç©ºå°„å·¡èˆªå¯¼å¼¹"
  weaponType: air-to-ground-missile
  category: cruise-missile

  specifications:
    weight: 600kg
    range: 1500km

  image:
    repository: registry.mil/weapons/akd20-cruise-missile
    tag: v3.0.0

  compatibility:
    aircraftTypes: [h6k]

---
# weapons/sensor-pods.yaml
apiVersion: airforce.mil/v1alpha1
kind: Weapon
metadata:
  name: sar-radar-pod
  namespace: weapons
spec:
  weaponName: "åˆæˆå­”å¾„é›·è¾¾åŠèˆ±"
  weaponType: sensor-pod

  image:
    repository: registry.mil/sensors/sar-radar
    tag: v2.0.0

  compatibility:
    aircraftTypes: [wz10]

---
apiVersion: airforce.mil/v1alpha1
kind: Weapon
metadata:
  name: eo-ir-sensor
  namespace: weapons
spec:
  weaponName: "å…‰ç”µ/çº¢å¤–ä¾¦å¯Ÿè®¾å¤‡"
  weaponType: sensor-pod

  image:
    repository: registry.mil/sensors/eo-ir
    tag: v1.5.0

  compatibility:
    aircraftTypes: [wz10]

---
apiVersion: airforce.mil/v1alpha1
kind: Weapon
metadata:
  name: ecm-pod
  namespace: weapons
spec:
  weaponName: "ç”µå­å¯¹æŠ—åŠèˆ±"
  weaponType: electronic-warfare-pod

  image:
    repository: registry.mil/ew/ecm-pod
    tag: v2.5.0

  compatibility:
    aircraftTypes: [j16d]
```

```bash
# å®‰è£…æ‰€æœ‰æ­¦å™¨èµ„æº
kubectl apply -f weapons/

# éªŒè¯
kubectl get weapons -n weapons
```

## äºŒã€åˆ›å»ºä»»åŠ¡

### 2.1 å®Œæ•´ä»»åŠ¡å®šä¹‰

```yaml
# missions/far-sea-strike.yaml
apiVersion: airforce.mil/v1alpha1
kind: Mission
metadata:
  name: far-sea-strike-001
  namespace: operations
spec:
  missionName: "è¿œæµ·æ–¹å‘é‡è¦ç›®æ ‡ç»¼åˆä¾¦å¯Ÿ-å‹åˆ¶-æ‰“å‡»ç¤ºèŒƒè¡ŒåŠ¨"
  missionType: strike
  priority: high

  objective:
    targetArea: "ä¸œæµ·æŸæµ·åŸŸ"
    targetCoordinates:
      latitude: 28.5
      longitude: 122.3
    targetDescription: "æµ·ä¸Šé«˜ä»·å€¼æœºåŠ¨å¹³å°"

  # ä¸‰ä¸ªé˜¶æ®µ
  stages:
  - name: stage1-isr
    displayName: "ä¾¦å¯Ÿä¸æ€åŠ¿å»ºç«‹"
    type: parallel           # é¢„è­¦ã€ä¾¦å¯Ÿã€æŠ¤èˆªå¹¶è¡Œ
    dependsOn: []
    timeout: 30m
    flightTasks:
    - aircraft: kj500
      role: awacs-control
      priority: critical
      weaponLoadout:
      - weapon: aesa-radar
      - weapon: datalink-pod
      taskParams:
        altitude: 8000m
        speed: 450km/h
        loiterTime: 30m

    - aircraft: wz10
      role: reconnaissance
      priority: high
      weaponLoadout:
      - weapon: sar-radar-pod
      - weapon: eo-ir-sensor
      taskParams:
        altitude: 12000m
        speed: 600km/h

    - aircraft: j20
      role: escort
      priority: high
      weaponLoadout:
      - weapon: pl10-missile
        quantity: 2
      taskParams:
        altitude: 10000m
        speed: 800km/h

  - name: stage2-suppression
    displayName: "åˆ¶ç©ºæ©æŠ¤ä¸ç”µå­å‹åˆ¶"
    type: parallel
    dependsOn: ["stage1-isr"]
    timeout: 45m
    flightTasks:
    - aircraft: j20
      role: air-superiority
      priority: critical
      weaponLoadout:
      - weapon: pl15-missile
        quantity: 4
      - weapon: pl10-missile
        quantity: 2
      taskParams:
        altitude: 11000m
        speed: 900km/h

    - aircraft: j16d
      role: electronic-warfare
      priority: high
      weaponLoadout:
      - weapon: ecm-pod
      - weapon: anti-radiation-missile
        quantity: 2
      taskParams:
        altitude: 9000m
        speed: 850km/h

    - aircraft: wz10
      role: electronic-reconnaissance
      priority: medium
      weaponLoadout:
      - weapon: elint-pod
      taskParams:
        altitude: 10000m
        speed: 600km/h

  - name: stage3-strike
    displayName: "è¿œç¨‹æ‰“å‡»ä¸è¯„ä¼°"
    type: sequential         # æ‰“å‡» â†’ è¯„ä¼° ä¸²è¡Œ
    dependsOn: ["stage2-suppression"]
    timeout: 60m
    flightTasks:
    - aircraft: h6k
      role: long-range-strike
      priority: critical
      weaponLoadout:
      - weapon: akd20-cruise-missile
        quantity: 4
      taskParams:
        altitude: 8000m
        speed: 750km/h
        launchDistance: 400km

    - aircraft: gj11
      role: stealth-strike
      priority: high
      weaponLoadout:
      - weapon: precision-guided-bomb
        quantity: 2
      taskParams:
        altitude: 7000m
        speed: 700km/h

    - aircraft: wz10
      role: damage-assessment
      priority: high
      weaponLoadout:
      - weapon: sar-radar-pod
      - weapon: eo-ir-sensor
      taskParams:
        altitude: 12000m
        speed: 600km/h

    - aircraft: yy20a
      role: aerial-refueling
      priority: medium
      weaponLoadout:
      - weapon: refueling-pod
      taskParams:
        altitude: 9000m
        speed: 600km/h
        refuelingArea: "support-area-1"

  config:
    failurePolicy:
      maxRetries: 3
      retryStrategy: exponential
      stageFailureAction: abort

    cancellationPolicy:
      gracePeriod: 300s
      cleanup: true

    coordination:
      dataLinkProtocol: "Link-16"
      commandFrequency: "UHF-243MHz"
```

### 2.2 æäº¤ä»»åŠ¡

```bash
# åˆ›å»ºä»»åŠ¡
kubectl apply -f missions/far-sea-strike.yaml

# æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€
kubectl get mission far-sea-strike-001 -n operations

# è¾“å‡ºç¤ºä¾‹ï¼š
# NAME                  PHASE     STAGES   TASKS   AGE
# far-sea-strike-001    Running   1/3      3/12    2m
```

## ä¸‰ã€ä»»åŠ¡æ‰§è¡Œæµç¨‹

### 3.1 é˜¶æ®µä¸€ï¼šä¾¦å¯Ÿä¸æ€åŠ¿å»ºç«‹

```bash
# æŸ¥çœ‹é˜¶æ®µçŠ¶æ€
kubectl get missionstage -n operations -l mission=far-sea-strike-001

# è¾“å‡ºï¼š
# NAME                            PHASE     TASKS   AGE
# far-sea-strike-001-stage1-isr   Running   3/3     2m

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
kubectl describe missionstage far-sea-strike-001-stage1-isr -n operations
```

**é˜¶æ®µä¸€çš„æ‰§è¡Œæµç¨‹ï¼š**

1. **Mission Controlleræ£€æµ‹åˆ°Missionåˆ›å»º**
   - åˆ›å»º`MissionStage: stage1-isr`
   - å› ä¸ºæ²¡æœ‰ä¾èµ–ï¼Œç›´æ¥è®¾ç½®`Phase=Running`

2. **Stage Controlleræ£€æµ‹åˆ°Stageå˜ä¸ºRunning**
   - è§£æFlightTaskså®šä¹‰
   - åˆ›å»º3ä¸ªFlightTaskèµ„æºï¼š
     - `ft-kj500-awacs-001`ï¼ˆç©ºè­¦-500é¢„è­¦ï¼‰
     - `ft-wz10-recon-001`ï¼ˆæ— ä¾¦-10ä¾¦å¯Ÿï¼‰
     - `ft-j20-escort-001`ï¼ˆæ­¼-20æŠ¤èˆªï¼‰
   - å› ä¸º`type=parallel`ï¼ŒåŒæ—¶å°†3ä¸ªFlightTaskè®¾ç½®ä¸º`Scheduled`

3. **FlightTask Controllerå¤„ç†3ä¸ªä»»åŠ¡**

   **ä»»åŠ¡1ï¼šft-kj500-awacs-001**
   ```yaml
   # FlightTaskè¯¦æƒ…
   apiVersion: airforce.mil/v1alpha1
   kind: FlightTask
   metadata:
     name: ft-kj500-awacs-001
   spec:
     aircraftRequirement:
       type: kj500
       minFuelLevel: 70
     weaponLoadout:
     - weaponRef: {name: aesa-radar}
     - weaponRef: {name: datalink-pod}
   status:
     phase: Running
     schedulingInfo:
       assignedNode: kj500-01
       assignedTime: "2024-03-15T10:00:30Z"
     podRef:
       name: ft-kj500-awacs-001-pod-abc123
   ```

   - FlightTask Controlleråˆ›å»ºPod
   - æ³¨å…¥`aesa-radar`å’Œ`datalink-pod` Sidecarå®¹å™¨
   - K8s Schedulerè°ƒåº¦åˆ°`kj500-01`èŠ‚ç‚¹
   - Podå¯åŠ¨ï¼Œæ‰§è¡Œé¢„è­¦ä»»åŠ¡

   **ä»»åŠ¡2ï¼šft-wz10-recon-001**
   - è°ƒåº¦åˆ°`wz10-01`èŠ‚ç‚¹
   - æ³¨å…¥`sar-radar-pod`å’Œ`eo-ir-sensor` Sidecar
   - æ‰§è¡Œä¾¦å¯Ÿä»»åŠ¡

   **ä»»åŠ¡3ï¼šft-j20-escort-001**
   - è°ƒåº¦åˆ°`j20-01`èŠ‚ç‚¹
   - æ³¨å…¥`pl10-missile` Sidecarï¼ˆ2æšï¼‰
   - æ‰§è¡ŒæŠ¤èˆªä»»åŠ¡

4. **ç›‘æ§ä»»åŠ¡æ‰§è¡Œ**

```bash
# æŸ¥çœ‹æ‰€æœ‰FlightTask
kubectl get flighttask -n operations -l stage=stage1-isr

# è¾“å‡ºï¼š
# NAME                    PHASE     AIRCRAFT   NODE       AGE
# ft-kj500-awacs-001      Running   kj500      kj500-01   3m
# ft-wz10-recon-001       Running   wz10       wz10-01    3m
# ft-j20-escort-001       Running   j20        j20-01     3m

# æŸ¥çœ‹å®é™…è¿è¡Œçš„Pod
kubectl get pods -n operations -l stage=stage1-isr

# è¾“å‡ºï¼š
# NAME                             READY   STATUS    NODE
# ft-kj500-awacs-001-pod-abc123    3/3     Running   kj500-01
# ft-wz10-recon-001-pod-def456     3/3     Running   wz10-01
# ft-j20-escort-001-pod-ghi789     2/2     Running   j20-01

# æŸ¥çœ‹Podè¯¦æƒ…ï¼ˆåŒ…å«Sidecarå®¹å™¨ï¼‰
kubectl describe pod ft-wz10-recon-001-pod-def456 -n operations

# è¾“å‡ºåŒ…å«ï¼š
# Containers:
#   aircraft-control:
#     Image: registry.mil/aircraft/wz10-control:v2.1.0
#   weapon-sar-radar-pod:
#     Image: registry.mil/sensors/sar-radar:v2.0.0
#   weapon-eo-ir-sensor:
#     Image: registry.mil/sensors/eo-ir:v1.5.0
```

5. **é˜¶æ®µä¸€å®Œæˆ**

30åˆ†é’Ÿåï¼Œæ‰€æœ‰3ä¸ªFlightTaskå®Œæˆï¼š

```bash
kubectl get flighttask -n operations -l stage=stage1-isr

# è¾“å‡ºï¼š
# NAME                    PHASE       AIRCRAFT   COMPLETION-TIME
# ft-kj500-awacs-001      Succeeded   kj500      2024-03-15T10:28:00Z
# ft-wz10-recon-001       Succeeded   wz10       2024-03-15T10:27:30Z
# ft-j20-escort-001       Succeeded   j20        2024-03-15T10:28:00Z

# Stage Controlleræ£€æµ‹åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆ
kubectl get missionstage far-sea-strike-001-stage1-isr -n operations

# è¾“å‡ºï¼š
# NAME                            PHASE       COMPLETION-TIME
# far-sea-strike-001-stage1-isr   Succeeded   2024-03-15T10:28:00Z
```

Mission Controlleræ£€æµ‹åˆ°Stage1å®Œæˆï¼Œå¯åŠ¨Stage2ã€‚

### 3.2 é˜¶æ®µäºŒï¼šåˆ¶ç©ºæ©æŠ¤ä¸ç”µå­å‹åˆ¶

```bash
# Mission Controlleråˆ›å»ºStage2
kubectl get missionstage -n operations

# è¾“å‡ºï¼š
# NAME                                  PHASE       AGE
# far-sea-strike-001-stage1-isr         Succeeded   30m
# far-sea-strike-001-stage2-suppression Running     1m
```

é˜¶æ®µäºŒåŒ…å«3ä¸ªå¹¶è¡Œä»»åŠ¡ï¼š
- `ft-j20-air-superiority-001`ï¼ˆæ­¼-20åˆ¶ç©ºï¼‰
- `ft-j16d-ew-001`ï¼ˆæ­¼-16Dç”µå­æˆ˜ï¼‰
- `ft-wz10-elint-001`ï¼ˆæ— ä¾¦-10ç”µå­ä¾¦å¯Ÿï¼‰

**è°ƒåº¦åœºæ™¯æ¼”ç¤ºï¼š**

å‡è®¾å½“å‰é£æœºèŠ‚ç‚¹çŠ¶æ€ï¼š

| èŠ‚ç‚¹ | å‹å· | çŠ¶æ€ | æ²¹é‡ | ä½ç½® | æ˜¯å¦ç©ºé—² |
|------|------|------|------|------|----------|
| j20-01 | j20 | ready | 75% | east-sea | æ˜¯ï¼ˆåˆšå®ŒæˆæŠ¤èˆªä»»åŠ¡ï¼‰ |
| j20-02 | j20 | ready | 90% | east-sea | æ˜¯ |
| j20-03 | j20 | maintenance | - | - | å¦ |

**è°ƒåº¦`ft-j20-air-superiority-001`ä»»åŠ¡ï¼š**

1. **Filteré˜¶æ®µï¼š**
   - j20-01: âœ… é€šè¿‡ï¼ˆå‹å·åŒ¹é…ï¼Œå°±ç»ªï¼Œæ²¹é‡75%>70%ï¼‰
   - j20-02: âœ… é€šè¿‡ï¼ˆå‹å·åŒ¹é…ï¼Œå°±ç»ªï¼Œæ²¹é‡90%>70%ï¼‰
   - j20-03: âŒ æ·˜æ±°ï¼ˆç»´æŠ¤ä¸­ï¼‰

2. **Scoreé˜¶æ®µï¼š**
   - j20-01è¯„åˆ†ï¼š75(ç‡ƒæ–™)Ã—3 + 100(ä½ç½®)Ã—2 + 70(ç»´æŠ¤)Ã—1 = 525
   - j20-02è¯„åˆ†ï¼š90(ç‡ƒæ–™)Ã—3 + 100(ä½ç½®)Ã—2 + 100(ç»´æŠ¤)Ã—1 = 670

3. **ç»“æœï¼šé€‰æ‹©j20-02**ï¼ˆè¯„åˆ†æ›´é«˜ï¼‰

```bash
# æŸ¥çœ‹è°ƒåº¦ç»“æœ
kubectl get flighttask ft-j20-air-superiority-001 -n operations -o yaml

# status.schedulingInfo:
#   assignedNode: j20-02
#   assignedTime: "2024-03-15T10:29:00Z"
#   schedulingAttempts: 1
```

### 3.3 é˜¶æ®µä¸‰ï¼šè¿œç¨‹æ‰“å‡»ä¸è¯„ä¼°

é˜¶æ®µä¸‰æ˜¯**sequentialï¼ˆä¸²è¡Œï¼‰**æ‰§è¡Œï¼š

```yaml
flightTasks:
- h6k (æ‰“å‡») â†’ gj11 (è¡¥å……æ‰“å‡») â†’ wz10 (è¯„ä¼°) â†’ yy20a (ä¿éšœ)
```

**æ‰§è¡Œæµç¨‹ï¼š**

1. **è½°-6Kè¿œç¨‹æ‰“å‡»**
   ```bash
   # é¦–å…ˆæ‰§è¡Œè½°-6Kä»»åŠ¡
   kubectl get flighttask ft-h6k-strike-001 -n operations

   # è¾“å‡ºï¼š
   # NAME                PHASE     AIRCRAFT   NODE     AGE
   # ft-h6k-strike-001   Running   h6k        h6k-01   2m
   ```

   è½°-6Kå‘å°„4æšAKD-20å·¡èˆªå¯¼å¼¹åï¼Œä»»åŠ¡å®Œæˆï¼š
   ```bash
   # 15åˆ†é’Ÿå
   kubectl get flighttask ft-h6k-strike-001 -n operations

   # è¾“å‡ºï¼š
   # NAME                PHASE       COMPLETION-TIME
   # ft-h6k-strike-001   Succeeded   2024-03-15T11:28:00Z
   ```

2. **æ”»å‡»-11éšèº«æ‰“å‡»**

   Stage Controlleræ£€æµ‹åˆ°h6kä»»åŠ¡å®Œæˆï¼Œå¯åŠ¨ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼š
   ```bash
   kubectl get flighttask ft-gj11-strike-001 -n operations

   # è¾“å‡ºï¼š
   # NAME                 PHASE     AIRCRAFT   NODE      AGE
   # ft-gj11-strike-001   Running   gj11       gj11-01   30s
   ```

3. **æ— ä¾¦-10æ•ˆæœè¯„ä¼°**

   æ”»å‡»-11å®Œæˆåï¼Œå¯åŠ¨è¯„ä¼°ä»»åŠ¡ï¼š
   ```bash
   kubectl get flighttask ft-wz10-bda-001 -n operations

   # è¾“å‡ºï¼š
   # NAME               PHASE     AIRCRAFT   NODE      AGE
   # ft-wz10-bda-001    Running   wz10       wz10-02   1m
   ```

4. **è¿æ²¹-20Aç©ºä¸­åŠ æ²¹**

   åŒæ—¶æä¾›ä¿éšœï¼š
   ```bash
   kubectl get flighttask ft-yy20a-refuel-001 -n operations

   # è¾“å‡ºï¼š
   # NAME                   PHASE     AIRCRAFT   NODE       AGE
   # ft-yy20a-refuel-001    Running   yy20a      yy20a-01   5m
   ```

### 3.4 ä»»åŠ¡å®Œæˆ

æ‰€æœ‰é˜¶æ®µå®Œæˆåï¼š

```bash
# æŸ¥çœ‹ä»»åŠ¡æœ€ç»ˆçŠ¶æ€
kubectl get mission far-sea-strike-001 -n operations -o yaml

# status:
#   phase: Succeeded
#   startTime: "2024-03-15T10:00:00Z"
#   completionTime: "2024-03-15T11:45:00Z"
#   stagesSummary:
#   - name: stage1-isr
#     phase: Succeeded
#     startTime: "2024-03-15T10:00:00Z"
#     completionTime: "2024-03-15T10:28:00Z"
#   - name: stage2-suppression
#     phase: Succeeded
#     startTime: "2024-03-15T10:28:00Z"
#     completionTime: "2024-03-15T11:10:00Z"
#   - name: stage3-strike
#     phase: Succeeded
#     startTime: "2024-03-15T11:10:00Z"
#     completionTime: "2024-03-15T11:45:00Z"
#   statistics:
#     totalFlightTasks: 12
#     succeededTasks: 12
#     failedTasks: 0
#   message: "ä»»åŠ¡æˆåŠŸå®Œæˆ"
```

## å››ã€æ•…éšœåœºæ™¯ä¸æ¢å¤

### 4.1 åœºæ™¯1ï¼šå•ä¸ªé£è¡Œä»»åŠ¡å¤±è´¥

å‡è®¾åœ¨é˜¶æ®µäºŒï¼Œ`ft-j16d-ew-001`ä»»åŠ¡çš„Podå¤±è´¥äº†ï¼š

```bash
# Podå¤±è´¥
kubectl get pod ft-j16d-ew-001-pod-xyz -n operations

# è¾“å‡ºï¼š
# NAME                      STATUS    RESTARTS   AGE
# ft-j16d-ew-001-pod-xyz    Failed    0          5m

# æŸ¥çœ‹å¤±è´¥åŸå› 
kubectl logs ft-j16d-ew-001-pod-xyz -n operations -c aircraft-control

# è¾“å‡ºï¼š
# Error: ç”µå­å¯¹æŠ—ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥
```

**è‡ªåŠ¨æ¢å¤æµç¨‹ï¼š**

1. FlightTask Controlleræ£€æµ‹åˆ°Podå¤±è´¥
2. å¢åŠ é‡è¯•è®¡æ•°ï¼š`retryCount: 1`
3. ç»™å¤±è´¥çš„èŠ‚ç‚¹æ·»åŠ Taintï¼ˆé˜²æ­¢å†æ¬¡è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ï¼‰
4. åˆ é™¤å¤±è´¥çš„Pod
5. é‡æ–°åˆ›å»ºPodï¼Œè°ƒåº¦åˆ°å¦ä¸€ä¸ªj16dèŠ‚ç‚¹

```bash
# æŸ¥çœ‹FlightTaskçŠ¶æ€
kubectl get flighttask ft-j16d-ew-001 -n operations -o yaml

# status:
#   phase: Retrying
#   retryCount: 1
#   lastRetryTime: "2024-03-15T10:35:00Z"
#   message: "ä»»åŠ¡å¤±è´¥ï¼Œå‡†å¤‡ç¬¬1æ¬¡é‡è¯•"

# 1åˆ†é’Ÿåï¼Œæ–°Podåˆ›å»ºå¹¶è°ƒåº¦åˆ°j16d-02
kubectl get flighttask ft-j16d-ew-001 -n operations

# è¾“å‡ºï¼š
# NAME              PHASE     AIRCRAFT   NODE       RETRY   AGE
# ft-j16d-ew-001    Running   j16d       j16d-02    1       6m

# æ–°PodæˆåŠŸè¿è¡Œ
kubectl get pod -n operations -l task=ft-j16d-ew-001

# è¾“å‡ºï¼š
# NAME                       STATUS     AGE
# ft-j16d-ew-001-pod-abc     Running    2m
```

### 4.2 åœºæ™¯2ï¼šæ•´ä¸ªé˜¶æ®µå¤±è´¥

å¦‚æœé˜¶æ®µäºŒçš„å…³é”®ä»»åŠ¡ï¼ˆj20åˆ¶ç©ºï¼‰å¤±è´¥3æ¬¡åä»æ— æ³•æ¢å¤ï¼š

```bash
# FlightTaskè¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°
kubectl get flighttask ft-j20-air-superiority-001 -n operations

# è¾“å‡ºï¼š
# NAME                          PHASE    RETRY   MESSAGE
# ft-j20-air-superiority-001    Failed   3       ä»»åŠ¡å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°

# Stage Controlleræ£€æµ‹åˆ°å…³é”®ä»»åŠ¡å¤±è´¥
kubectl get missionstage far-sea-strike-001-stage2-suppression -n operations

# è¾“å‡ºï¼š
# NAME                                  PHASE    MESSAGE
# far-sea-strike-001-stage2-suppression Failed   é˜¶æ®µå†…æœ‰å…³é”®ä»»åŠ¡å¤±è´¥

# Mission Controlleræ ¹æ®failurePolicyå¤„ç†
# failurePolicy.stageFailureAction = abort
kubectl get mission far-sea-strike-001 -n operations

# è¾“å‡ºï¼š
# NAME                  PHASE    MESSAGE
# far-sea-strike-001    Failed   é˜¶æ®µ2å¤±è´¥ï¼Œä»»åŠ¡ç»ˆæ­¢
```

### 4.3 åœºæ™¯3ï¼šåŠ¨æ€æ·»åŠ æ–°é˜¶æ®µ

ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒæŒ‡æŒ¥éƒ¨å†³å®šæ·»åŠ ä¸€ä¸ªæ–°çš„æˆ˜æŸè¯„ä¼°é˜¶æ®µï¼š

```bash
# ä¿®æ”¹Mission CRD
kubectl edit mission far-sea-strike-001 -n operations

# æ·»åŠ æ–°é˜¶æ®µï¼š
spec:
  stages:
  # ... ç°æœ‰é˜¶æ®µ ...
  - name: stage4-detailed-bda
    displayName: "è¯¦ç»†æˆ˜æŸè¯„ä¼°"
    type: parallel
    dependsOn: ["stage3-strike"]
    timeout: 30m
    flightTasks:
    - aircraft: wz10
      role: detailed-assessment
      weaponLoadout:
      - weapon: high-res-camera
      - weapon: sar-radar-pod

# ä¿å­˜åï¼ŒMission Controllerè‡ªåŠ¨æ£€æµ‹åˆ°å˜åŒ–
# åˆ›å»ºæ–°çš„MissionStage
kubectl get missionstage -n operations

# è¾“å‡ºï¼š
# NAME                                      PHASE     AGE
# far-sea-strike-001-stage1-isr             Succeeded 2h
# far-sea-strike-001-stage2-suppression     Succeeded 1.5h
# far-sea-strike-001-stage3-strike          Succeeded 30m
# far-sea-strike-001-stage4-detailed-bda    Pending   1m

# ç­‰å¾…stage3å®Œæˆåï¼Œstage4è‡ªåŠ¨å¼€å§‹æ‰§è¡Œ
```

### 4.4 åœºæ™¯4ï¼šæ­¦å™¨çƒ­æ›´æ–°

åœ¨ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘ç°PL-15å¯¼å¼¹æœ‰bugï¼Œéœ€è¦ç´§æ€¥æ›´æ–°ï¼š

```bash
# æ›´æ–°Weapon CRDçš„é•œåƒç‰ˆæœ¬
kubectl edit weapon pl15-missile -n weapons

# ä¿®æ”¹ï¼š
spec:
  image:
    tag: v2.3.1  # ä»v2.3.0å‡çº§åˆ°v2.3.1

# Weapon Controlleræ£€æµ‹åˆ°å˜åŒ–
# æŸ¥æ‰¾æ‰€æœ‰ä½¿ç”¨PL-15çš„Pod
# é€ä¸ªæ»šåŠ¨æ›´æ–°

# ç›‘æ§æ›´æ–°è¿‡ç¨‹
kubectl get pods -n operations -l weapon=pl15-missile --watch

# è¾“å‡ºï¼š
# ft-j20-air-001-pod-abc   3/3   Terminating   j20-01   10m
# ft-j20-air-001-pod-def   0/3   Pending       <none>   0s
# ft-j20-air-001-pod-def   0/3   Pending       j20-02   0s
# ft-j20-air-001-pod-def   3/3   Running       j20-02   5s
```

## äº”ã€ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### 5.1 æŸ¥çœ‹ä»»åŠ¡ä»ªè¡¨æ¿

```bash
# ä½¿ç”¨kubectlè·å–ä»»åŠ¡æ¦‚è§ˆ
kubectl get mission,missionstage,flighttask -n operations

# è¾“å‡ºï¼š
# NAME                                        PHASE     AGE
# mission.airforce.mil/far-sea-strike-001     Running   1h

# NAME                                                      PHASE       AGE
# missionstage.airforce.mil/far-sea-strike-001-stage1-isr   Succeeded   1h
# missionstage.airforce.mil/far-sea-strike-001-stage2-suppression Running 30m

# NAME                                                PHASE     AIRCRAFT   NODE
# flighttask.airforce.mil/ft-kj500-awacs-001          Succeeded kj500      kj500-01
# flighttask.airforce.mil/ft-wz10-recon-001           Succeeded wz10       wz10-01
# flighttask.airforce.mil/ft-j20-escort-001           Succeeded j20        j20-01
# flighttask.airforce.mil/ft-j20-air-superiority-001  Running   j20        j20-02
# flighttask.airforce.mil/ft-j16d-ew-001              Running   j16d       j16d-01
# flighttask.airforce.mil/ft-wz10-elint-001           Running   wz10       wz10-02
```

### 5.2 æŸ¥çœ‹é£æœºèŠ‚ç‚¹çŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰é£æœºèŠ‚ç‚¹
kubectl get nodes -l aircraft.mil/type -o custom-columns=\
NAME:.metadata.name,\
TYPE:.metadata.labels.aircraft\\.mil/type,\
STATUS:.metadata.labels.aircraft\\.mil/status,\
FUEL:.metadata.labels.aircraft\\.mil/fuel\\.level,\
LOCATION:.metadata.labels.aircraft\\.mil/location\\.zone,\
TASK:.metadata.labels.aircraft\\.mil/mission\\.current

# è¾“å‡ºï¼š
# NAME       TYPE    STATUS   FUEL   LOCATION   TASK
# kj500-01   kj500   ready    80%    east-sea
# wz10-01    wz10    ready    75%    east-sea
# wz10-02    wz10    busy     70%    east-sea   ft-wz10-elint-001
# j20-01     j20     ready    68%    east-sea
# j20-02     j20     busy     85%    east-sea   ft-j20-air-superiority-001
# j16d-01    j16d    busy     82%    east-sea   ft-j16d-ew-001
# h6k-01     h6k     ready    90%    inland
# gj11-01    gj11    ready    95%    inland
# yy20a-01   yy20a   ready    88%    inland
```

### 5.3 æŸ¥çœ‹äº‹ä»¶æ—¥å¿—

```bash
# æŸ¥çœ‹Missionçš„äº‹ä»¶
kubectl describe mission far-sea-strike-001 -n operations

# Events:
# Type    Reason             Age   Message
# ----    ------             ----  -------
# Normal  MissionCreated     1h    ä»»åŠ¡å·²åˆ›å»º
# Normal  StageCreated       1h    åˆ›å»ºé˜¶æ®µ: stage1-isr
# Normal  StageStarted       1h    é˜¶æ®µ1å¼€å§‹æ‰§è¡Œ
# Normal  StageCompleted     30m   é˜¶æ®µ1å®Œæˆ
# Normal  StageCreated       30m   åˆ›å»ºé˜¶æ®µ: stage2-suppression
# Normal  StageStarted       30m   é˜¶æ®µ2å¼€å§‹æ‰§è¡Œ
```

### 5.4 Grafanaä»ªè¡¨æ¿ï¼ˆç¤ºæ„ï¼‰

å¯ä»¥é€šè¿‡Prometheuså’ŒGrafanaæ„å»ºç›‘æ§ä»ªè¡¨æ¿ï¼š

**ä»»åŠ¡æ‰§è¡Œä»ªè¡¨æ¿ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä»»åŠ¡: far-sea-strike-001                               â”‚
â”‚ çŠ¶æ€: Running  â”‚  è¿›åº¦: 60%  â”‚  è€—æ—¶: 1h 15m          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é˜¶æ®µè¿›åº¦:                                              â”‚
â”‚  âœ… Stage 1: ä¾¦å¯Ÿä¸æ€åŠ¿å»ºç«‹    [====] 100%  30m       â”‚
â”‚  âœ… Stage 2: åˆ¶ç©ºæ©æŠ¤ä¸å‹åˆ¶    [====] 100%  40m       â”‚
â”‚  ğŸ”„ Stage 3: è¿œç¨‹æ‰“å‡»ä¸è¯„ä¼°    [==--]  50%  25m/60m   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é£è¡Œä»»åŠ¡ç»Ÿè®¡:                                          â”‚
â”‚  æ€»æ•°: 12  â”‚  æˆåŠŸ: 6  â”‚  è¿è¡Œä¸­: 4  â”‚  å¤±è´¥: 0       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é£æœºçŠ¶æ€:                                              â”‚
â”‚  å°±ç»ª: 5  â”‚  æ‰§è¡Œä¸­: 4  â”‚  ç»´æŠ¤: 0  â”‚  ç¦»çº¿: 0       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ­¦å™¨ä½¿ç”¨ç»Ÿè®¡:                                          â”‚
â”‚  PL-15: å‘å°„ 8/12  â”‚  AKD-20: å‘å°„ 4/4              â”‚
â”‚  PL-10: å‘å°„ 2/6   â”‚  ç²¾ç¡®ç‚¸å¼¹: å‘å°„ 2/4            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å…­ã€ä»»åŠ¡å®Œæˆåçš„æ¸…ç†

### 6.1 è‡ªåŠ¨æ¸…ç†

ä»»åŠ¡å®Œæˆåï¼Œèµ„æºä¼šè‡ªåŠ¨æ¸…ç†ï¼š

```bash
# Podå·²ç»ˆæ­¢
kubectl get pods -n operations -l mission=far-sea-strike-001

# è¾“å‡ºï¼š
# NAME                              STATUS      AGE
# ft-kj500-awacs-001-pod-abc123     Completed   2h
# ft-wz10-recon-001-pod-def456      Completed   2h
# ...

# é£æœºèŠ‚ç‚¹æ¢å¤å°±ç»ªçŠ¶æ€
kubectl get nodes -l aircraft.mil/type -o custom-columns=\
NAME:.metadata.name,\
STATUS:.metadata.labels.aircraft\\.mil/status,\
TASK:.metadata.labels.aircraft\\.mil/mission\\.current

# è¾“å‡ºï¼š
# NAME       STATUS   TASK
# j20-01     ready
# j20-02     ready
# ...
```

### 6.2 ä¿ç•™ä»»åŠ¡è®°å½•

```bash
# Mission/Stage/FlightTaskèµ„æºä»ç„¶ä¿ç•™ï¼Œå¯ä¾›æŸ¥è¯¢
kubectl get mission far-sea-strike-001 -n operations

# æŸ¥çœ‹ä»»åŠ¡æ‰§è¡Œå†å²
kubectl get flighttask -n operations -l mission=far-sea-strike-001 \
  -o custom-columns=\
NAME:.metadata.name,\
PHASE:.status.phase,\
NODE:.status.schedulingInfo.assignedNode,\
START:.status.startTime,\
DURATION:.status.executionDuration
```

### 6.3 å½’æ¡£ä»»åŠ¡

```bash
# å¯¼å‡ºä»»åŠ¡é…ç½®å’ŒçŠ¶æ€ï¼ˆç”¨äºå½’æ¡£ï¼‰
kubectl get mission far-sea-strike-001 -n operations -o yaml > \
  archive/far-sea-strike-001-$(date +%Y%m%d).yaml

# åˆ é™¤ä»»åŠ¡ï¼ˆçº§è”åˆ é™¤æ‰€æœ‰å­èµ„æºï¼‰
kubectl delete mission far-sea-strike-001 -n operations

# Missionã€MissionStageã€FlightTaskã€Podå…¨éƒ¨åˆ é™¤
```

## ä¸ƒã€æ€»ç»“

é€šè¿‡æœ¬ç¤ºä¾‹ï¼Œæˆ‘ä»¬å®Œæ•´å±•ç¤ºäº†ï¼š

1. âœ… **ä»»åŠ¡åˆ›å»º**ï¼šé€šè¿‡å£°æ˜å¼YAMLå®šä¹‰å¤æ‚çš„å¤šé˜¶æ®µä»»åŠ¡
2. âœ… **è‡ªåŠ¨è°ƒåº¦**ï¼šK8sæ ¹æ®é£æœºèƒ½åŠ›æ™ºèƒ½åˆ†é…ä»»åŠ¡
3. âœ… **æ­¦å™¨æŒ‚è½½**ï¼šSidecaræ¨¡å¼åŠ¨æ€æ³¨å…¥æ­¦å™¨å®¹å™¨
4. âœ… **é˜¶æ®µååŒ**ï¼šæ”¯æŒä¸²è¡Œã€å¹¶è¡Œã€ä¾èµ–å…³ç³»
5. âœ… **æ•…éšœæ¢å¤**ï¼šè‡ªåŠ¨é‡è¯•ã€é‡æ–°è°ƒåº¦
6. âœ… **åŠ¨æ€æ›´æ–°**ï¼šä»»åŠ¡è¿è¡Œæ—¶æ·»åŠ é˜¶æ®µã€æ›´æ–°æ­¦å™¨
7. âœ… **ç›‘æ§è¿½è¸ª**ï¼šå®Œæ•´çš„çŠ¶æ€è¿½è¸ªå’Œäº‹ä»¶æ—¥å¿—

è¿™å¥—æ–¹æ¡ˆå……åˆ†åˆ©ç”¨äº†K8sçš„èƒ½åŠ›ï¼Œå°†ç©ºå†›ä½œæˆ˜ä»»åŠ¡æ˜ å°„ä¸ºäº‘åŸç”Ÿèµ„æºï¼Œå®ç°äº†çµæ´»ã€å¯é ã€å¯æ‰©å±•çš„ä»»åŠ¡ç¼–æ’ç³»ç»Ÿã€‚
